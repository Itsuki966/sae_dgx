# LLM迎合性分析 - Google Colab最適化版依存関係
# =====================================================
# 
# この requirements-colab.txt は Google Colab 環境に最適化されており、
# インストール時のハングアップ問題を解決するために設計されています。
#
# 特徴:
# - 段階的インストールのための最小限の依存関係
# - バージョン競合を避けるための固定バージョン
# - Colab の事前インストールライブラリとの競合回避
# - メモリ効率化を重視した軽量構成

# ========================================
# Phase 1: Core ML Libraries (最重要)
# ========================================

# PyTorch (GPU対応版 - Colab環境に最適化)
torch>=2.0.0,<2.5.0
torchvision>=0.15.0,<0.20.0
torchaudio>=2.0.0,<2.5.0

# HuggingFace ecosystem (必須)
transformers>=4.35.0,<4.45.0
tokenizers>=0.14.0,<0.20.0
accelerate>=0.24.0,<0.35.0

# ========================================
# Phase 2: SAE Analysis Core (核心機能)
# ========================================

# SAE Lens - 迎合性分析の核心ライブラリ
sae-lens>=3.0.0
transformer-lens>=2.5.0,<3.0.0

# ========================================
# Phase 3: Data & Computation (基本機能)
# ========================================

# NumPy ecosystem (軽量バージョン)
numpy>=1.24.0,<1.27.0
pandas>=1.5.0,<2.2.0

# ========================================
# Phase 4: Visualization & UI (可視化)
# ========================================

# Interactive visualization
plotly>=5.15.0,<5.25.0

# Progress bars
tqdm>=4.65.0,<4.70.0

# ========================================
# Phase 5: Optional Enhancements (オプション)
# ========================================

# JSON handling improvements (optional)
jsonlines>=3.1.0,<4.0.0

# Memory profiling (development only)
# psutil>=5.9.0,<6.0.0  # コメントアウト - Colabでは不要

# ========================================
# 除外項目 (Colabと競合するため)
# ========================================

# jupyter                 # Colabに事前インストール済み
# notebook                # Colabに事前インストール済み
# ipython                 # Colabに事前インストール済み
# matplotlib              # Colabに事前インストール済み (plotlyで代替)
# scipy                   # 必要に応じて個別インストール
# scikit-learn            # 現在の分析では不要
# seaborn                 # plotlyで代替
# triton                  # 自動インストールに依存 (手動指定でハングアップリスク)

# ========================================
# 重要な注意事項
# ========================================
#
# 1. バージョン範囲指定の理由:
#    - 最新版への自動アップデートによる互換性問題を防止
#    - セキュリティアップデートは受け入れつつ、破壊的変更を回避
#
# 2. triton除外の理由:
#    - ソースからのビルドが必要な場合があるため、インストール時間が極端に長い
#    - PyTorchインストール時に自動的に適切なバージョンが選択される
#
# 3. Colab事前インストールライブラリとの競合回避:
#    - Colabには多くのライブラリが事前インストールされているため、
#      明示的に必要なもののみをインストールして競合を回避
#
# 4. 段階的インストール推奨:
#    - launcher_colab.ipynb の段階的インストール機能使用を推奨
#    - 問題が発生した場合の切り分けが容易
#
# 5. メモリ効率化:
#    - 不要なライブラリを除外してRAM使用量を最小化
#    - T4 GPU (15GB VRAM) での安定動作を重視